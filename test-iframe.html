<!DOCTYPE html>
<html>

<head>
    <title>–¢–µ—Å—Ç LED –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞</title>
    <meta charset="utf-8">
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üßÆ</text></svg>">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        iframe {
            width: 100%;
            height: 600px;
            border: 1px solid #ccc;
        }

        .test-links {
            margin-bottom: 20px;
        }

        .test-links a {
            margin-right: 10px;
            padding: 5px 10px;
            background: #007cba;
            color: white;
            text-decoration: none;
            border-radius: 3px;
        }

        .status {
            margin: 10px 0;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 3px;
        }

        .debug-info {
            margin: 10px 0;
            padding: 10px;
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 3px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }

        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }

        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }

        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
        }
    </style>
</head>

<body>
    <h1>–¢–µ—Å—Ç LED –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞</h1>

    <div class="test-links">
        <a href="#" onclick="testWidget()">–¢–µ—Å—Ç –≤–∏–¥–∂–µ—Ç–∞</a>
        <a href="#" onclick="testCalculator()">–¢–µ—Å—Ç –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞</a>
        <a href="#" onclick="testRealParams()">–¢–µ—Å—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</a>
        <a href="#" onclick="clearLog()">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</a>
        <a href="#" onclick="detailedDiagnostics()" style="background: #dc3545;">–ü–û–î–†–û–ë–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê</a>
    </div>

    <div class="status" id="status">–ì–æ—Ç–æ–≤ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é</div>

    <div class="debug-info" id="debug-log">
        <strong>–î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π –ª–æ–≥:</strong><br>
        <span id="log-content">–û–∂–∏–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è...</span>
    </div>

    <iframe id="test-frame" src=""></iframe>

    <script>
        let logContent = '';

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = `[${timestamp}] ${message}\n`;
            logContent += logEntry;

            const logElement = document.getElementById('log-content');
            logElement.innerHTML = logContent.replace(/\n/g, '<br>');

            const debugLog = document.getElementById('debug-log');
            debugLog.className = `debug-info ${type}`;

            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        function updateStatus(message) {
            document.getElementById('status').innerHTML = message + ' - ' + new Date().toLocaleTimeString();
            log(`–°—Ç–∞—Ç—É—Å: ${message}`, 'info');
        }

        function clearLog() {
            logContent = '';
            document.getElementById('log-content').innerHTML = '–õ–æ–≥ –æ—á–∏—â–µ–Ω';
            document.getElementById('debug-log').className = 'debug-info';
        }

        function detailedDiagnostics() {
            log('=== –ü–û–î–†–û–ë–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê IFRAME ===', 'info');

            const iframe = document.getElementById('test-frame');
            if (!iframe) {
                log('Iframe –Ω–µ –Ω–∞–π–¥–µ–Ω!', 'error');
                return;
            }

            log(`Iframe src: ${iframe.src}`, 'info');
            log(`Iframe readyState: ${iframe.contentDocument ? iframe.contentDocument.readyState : 'no access'}`, 'info');
            log(`Iframe contentWindow: ${iframe.contentWindow ? 'available' : 'not available'}`, 'info');

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ iframe
            try {
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                if (iframeDoc) {
                    log(`Iframe document title: ${iframeDoc.title}`, 'info');
                    log(`Iframe document URL: ${iframeDoc.URL}`, 'info');
                    log(`Iframe document readyState: ${iframeDoc.readyState}`, 'info');

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º body
                    const body = iframeDoc.body;
                    if (body) {
                        log(`Iframe body exists: ${body ? 'yes' : 'no'}`, 'info');
                        log(`Iframe body innerHTML length: ${body.innerHTML.length}`, 'info');
                        log(`Iframe body first 200 chars: ${body.innerHTML.substring(0, 200)}`, 'info');
                    } else {
                        log('Iframe body is null!', 'error');
                    }

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º root div
                    const rootDiv = iframeDoc.getElementById('root');
                    if (rootDiv) {
                        log('Root div –Ω–∞–π–¥–µ–Ω –≤ iframe!', 'success');
                        log(`Root div innerHTML length: ${rootDiv.innerHTML.length}`, 'info');
                        log(`Root div first 200 chars: ${rootDiv.innerHTML.substring(0, 200)}`, 'info');
                    } else {
                        log('Root div –ù–ï –Ω–∞–π–¥–µ–Ω –≤ iframe!', 'error');
                    }

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—à–∏–±–∫–∏
                    const errorElements = iframeDoc.querySelectorAll('h1, h2, h3, .error, .not-found');
                    if (errorElements.length > 0) {
                        log(`–ù–∞–π–¥–µ–Ω–æ ${errorElements.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏:`, 'error');
                        errorElements.forEach((el, index) => {
                            log(`–û—à–∏–±–∫–∞ ${index + 1}: ${el.textContent}`, 'error');
                        });
                    }

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º
                    const allElements = iframeDoc.querySelectorAll('*');
                    log(`–í—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ iframe: ${allElements.length}`, 'info');

                    // –ò—â–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º "404" –∏–ª–∏ "–Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
                    const errorTextElements = Array.from(allElements).filter(el =>
                        el.textContent && (
                            el.textContent.includes('404') ||
                            el.textContent.includes('–Ω–µ –Ω–∞–π–¥–µ–Ω–∞') ||
                            el.textContent.includes('not found')
                        )
                    );

                    if (errorTextElements.length > 0) {
                        log(`–ù–∞–π–¥–µ–Ω–æ ${errorTextElements.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å —Ç–µ–∫—Å—Ç–æ–º –æ—à–∏–±–∫–∏:`, 'error');
                        errorTextElements.forEach((el, index) => {
                            log(`–û—à–∏–±–∫–∞ ${index + 1}: ${el.textContent.trim()}`, 'error');
                        });
                    }

                } else {
                    log('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ iframe document (CORS)', 'warning');
                }
            } catch (error) {
                log(`–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ iframe: ${error.message}`, 'error');
            }
        }

        function testWidget() {
            log('=== –ù–ê–ß–ê–õ–û –¢–ï–°–¢–ê –í–ò–î–ñ–ï–¢–ê ===', 'info');
            updateStatus('–¢–µ—Å—Ç–∏—Ä—É—é –≤–∏–¥–∂–µ—Ç...');

            const url = '/apps/led-calculator-widget/public/index.php?PLACEMENT=CRM_DEAL_DETAIL_ACTIVITY&ID=5230&member_id=test&AUTH_ID=test&DOMAIN=test.bitrix24.ru';
            log(`URL –≤–∏–¥–∂–µ—Ç–∞: ${url}`, 'info');

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –≤–∏–¥–∂–µ—Ç–∞
            fetch(url)
                .then(response => {
                    log(`–í–∏–¥–∂–µ—Ç HTTP —Å—Ç–∞—Ç—É—Å: ${response.status} ${response.statusText}`, response.ok ? 'success' : 'error');
                    return response.text();
                })
                .then(html => {
                    log(`–í–∏–¥–∂–µ—Ç —Ä–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞: ${html.length} –±–∞–π—Ç`, 'info');
                    if (html.includes('iframe')) {
                        log('–í–∏–¥–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç iframe - OK', 'success');

                        // –ò–∑–≤–ª–µ–∫–∞–µ–º src –∏–∑ iframe –≤–∏–¥–∂–µ—Ç–∞
                        const iframeMatch = html.match(/src="([^"]+)"/);
                        if (iframeMatch) {
                            const calculatorUrl = iframeMatch[1];
                            log(`–ù–∞–π–¥–µ–Ω URL –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –≤ –≤–∏–¥–∂–µ—Ç–µ: ${calculatorUrl}`, 'success');

                            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –≤ iframe
                            document.getElementById('test-frame').src = calculatorUrl;
                            log('–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –∑–∞–≥—Ä—É–∂–µ–Ω –≤ iframe', 'info');
                        } else {
                            log('–ù–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ URL –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞ –≤ –≤–∏–¥–∂–µ—Ç–µ', 'error');
                            document.getElementById('test-frame').src = url;
                        }
                    } else {
                        log('–í–∏–¥–∂–µ—Ç –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç iframe - –û–®–ò–ë–ö–ê', 'error');
                        document.getElementById('test-frame').src = url;
                    }
                })
                .catch(error => {
                    log(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –≤–∏–¥–∂–µ—Ç–∞: ${error.message}`, 'error');
                    document.getElementById('test-frame').src = url;
                });

            log('Iframe src —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω', 'info');
        }

        function testCalculator() {
            log('=== –ù–ê–ß–ê–õ–û –¢–ï–°–¢–ê –ö–ê–õ–¨–ö–£–õ–Ø–¢–û–†–ê ===', 'info');
            updateStatus('–¢–µ—Å—Ç–∏—Ä—É—é –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä...');

            const url = '/apps/led-calculator/index.html?dealId=5230&domain=ledts.bitrix24.ru';
            log(`URL –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞: ${url}`, 'info');

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
            fetch(url)
                .then(response => {
                    log(`–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä HTTP —Å—Ç–∞—Ç—É—Å: ${response.status} ${response.statusText}`, response.ok ? 'success' : 'error');
                    return response.text();
                })
                .then(html => {
                    log(`–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Ä–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞: ${html.length} –±–∞–π—Ç`, 'info');
                    if (html.includes('Calculator')) {
                        log('–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π title - OK', 'success');
                    } else {
                        log('–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –ù–ï —Å–æ–¥–µ—Ä–∂–∏—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π title - –û–®–ò–ë–ö–ê', 'error');
                    }
                })
                .catch(error => {
                    log(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞: ${error.message}`, 'error');
                });

            document.getElementById('test-frame').src = url;
            log('Iframe src —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω', 'info');
        }

        function testRealParams() {
            log('=== –ù–ê–ß–ê–õ–û –¢–ï–°–¢–ê –° –†–ï–ê–õ–¨–ù–´–ú–ò –ü–ê–†–ê–ú–ï–¢–†–ê–ú–ò ===', 'info');
            updateStatus('–¢–µ—Å—Ç–∏—Ä—É—é —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏...');

            const url = '/apps/led-calculator-widget/public/index.php?PLACEMENT=CRM_DEAL_DETAIL_ACTIVITY&ID=5230&member_id=2ed3b3005a7c2a8f82e51326f960a106&AUTH_ID=test123&DOMAIN=ledts.bitrix24.ru';
            log(`URL —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: ${url}`, 'info');

            document.getElementById('test-frame').src = url;
            log('Iframe src —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω', 'info');
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –≤–∏–¥–∂–µ—Ç –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.onload = function () {
            log('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞', 'success');
            updateStatus('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            testWidget();
        };

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ iframe
        document.getElementById('test-frame').onload = function () {
            log('Iframe –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
            updateStatus('Iframe –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');

            try {
                const iframe = document.getElementById('test-frame');
                const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;

                if (iframeDoc) {
                    log(`Iframe title: ${iframeDoc.title}`, 'info');
                    log(`Iframe URL: ${iframeDoc.URL}`, 'info');

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ iframe
                    const rootDiv = iframeDoc.getElementById('root');
                    if (rootDiv) {
                        log('Root div –Ω–∞–π–¥–µ–Ω –≤ iframe', 'success');
                        log(`Root div —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ: ${rootDiv.innerHTML.substring(0, 200)}...`, 'info');

                        if (rootDiv.innerHTML.includes('Calculator')) {
                            log('React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!', 'success');
                        } else if (rootDiv.innerHTML.trim() === '') {
                            log('Root div –ø—É—Å—Ç–æ–π - React –Ω–µ —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è!', 'error');
                        } else {
                            log('Root div —Å–æ–¥–µ—Ä–∂–∏—Ç —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ', 'warning');
                        }
                    } else {
                        log('Root div –ù–ï –Ω–∞–π–¥–µ–Ω –≤ iframe!', 'error');
                    }

                    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—à–∏–±–∫–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ iframe
                    const scripts = iframeDoc.querySelectorAll('script');
                    log(`–ù–∞–π–¥–µ–Ω–æ —Å–∫—Ä–∏–ø—Ç–æ–≤: ${scripts.length}`, 'info');

                    if (iframeDoc.title.includes('404')) {
                        log('Iframe —Å–æ–¥–µ—Ä–∂–∏—Ç 404 –æ—à–∏–±–∫—É!', 'error');
                    } else if (iframeDoc.title.includes('Calculator')) {
                        log('Iframe –∑–∞–≥—Ä—É–∑–∏–ª –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —É—Å–ø–µ—à–Ω–æ!', 'success');
                    } else {
                        log(`Iframe –∑–∞–≥—Ä—É–∑–∏–ª: ${iframeDoc.title}`, 'warning');
                    }
                } else {
                    log('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É iframe (CORS)', 'warning');
                }
            } catch (error) {
                log(`–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ iframe: ${error.message}`, 'error');
            }
        };

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ iframe
        document.getElementById('test-frame').onerror = function () {
            log('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ iframe', 'error');
            updateStatus('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ iframe');
        };

        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞–∂–¥—ã–µ 2 —Å–µ–∫—É–Ω–¥—ã
        setInterval(function () {
            const iframe = document.getElementById('test-frame');
            if (iframe && iframe.src) {
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    if (iframeDoc && iframeDoc.title) {
                        if (iframeDoc.title.includes('404')) {
                            log('–û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ 404 –æ—à–∏–±–∫–∞ –≤ iframe!', 'error');
                        }
                    }
                } catch (error) {
                    // CORS –æ—à–∏–±–∫–∞ - –Ω–æ—Ä–º–∞–ª—å–Ω–æ
                }

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å iframe
                const rect = iframe.getBoundingClientRect();
                const computedStyle = window.getComputedStyle(iframe);

                log(`Iframe —Ä–∞–∑–º–µ—Ä—ã: ${rect.width}x${rect.height}`, 'info');
                log(`Iframe display: ${computedStyle.display}`, 'info');
                log(`Iframe visibility: ${computedStyle.visibility}`, 'info');
                log(`Iframe opacity: ${computedStyle.opacity}`, 'info');
                log(`Iframe z-index: ${computedStyle.zIndex}`, 'info');

                // –ü–û–î–†–û–ë–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê IFRAME
                log(`=== –ü–û–î–†–û–ë–ù–ê–Ø –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê IFRAME ===`, 'info');
                log(`Iframe src: ${iframe.src}`, 'info');
                log(`Iframe readyState: ${iframe.contentDocument ? iframe.contentDocument.readyState : 'no access'}`, 'info');
                log(`Iframe contentWindow: ${iframe.contentWindow ? 'available' : 'not available'}`, 'info');

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ iframe
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    if (iframeDoc) {
                        log(`Iframe document title: ${iframeDoc.title}`, 'info');
                        log(`Iframe document URL: ${iframeDoc.URL}`, 'info');
                        log(`Iframe document readyState: ${iframeDoc.readyState}`, 'info');

                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º body
                        const body = iframeDoc.body;
                        if (body) {
                            log(`Iframe body exists: ${body ? 'yes' : 'no'}`, 'info');
                            log(`Iframe body innerHTML length: ${body.innerHTML.length}`, 'info');
                            log(`Iframe body first 200 chars: ${body.innerHTML.substring(0, 200)}`, 'info');
                        } else {
                            log('Iframe body is null!', 'error');
                        }

                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º root div
                        const rootDiv = iframeDoc.getElementById('root');
                        if (rootDiv) {
                            log('Root div –Ω–∞–π–¥–µ–Ω –≤ iframe!', 'success');
                            log(`Root div innerHTML length: ${rootDiv.innerHTML.length}`, 'info');
                            log(`Root div first 200 chars: ${rootDiv.innerHTML.substring(0, 200)}`, 'info');
                        } else {
                            log('Root div –ù–ï –Ω–∞–π–¥–µ–Ω –≤ iframe!', 'error');
                        }

                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –æ—à–∏–±–∫–∏
                        const errorElements = iframeDoc.querySelectorAll('h1, h2, h3, .error, .not-found');
                        if (errorElements.length > 0) {
                            log(`–ù–∞–π–¥–µ–Ω–æ ${errorElements.length} —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –æ—à–∏–±–∫–∞–º–∏:`, 'error');
                            errorElements.forEach((el, index) => {
                                log(`–û—à–∏–±–∫–∞ ${index + 1}: ${el.textContent}`, 'error');
                            });
                        }
                    } else {
                        log('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ iframe document (CORS)', 'warning');
                    }
                } catch (error) {
                    log(`–û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ iframe: ${error.message}`, 'error');
                }

                if (rect.width === 0 || rect.height === 0) {
                    log('Iframe –∏–º–µ–µ—Ç –Ω—É–ª–µ–≤—ã–µ —Ä–∞–∑–º–µ—Ä—ã!', 'error');
                }

                if (computedStyle.display === 'none') {
                    log('Iframe —Å–∫—Ä—ã—Ç (display: none)!', 'error');
                }

                if (computedStyle.visibility === 'hidden') {
                    log('Iframe –Ω–µ–≤–∏–¥–∏–º (visibility: hidden)!', 'error');
                }
            }
        }, 2000);
    </script>
</body>

</html>